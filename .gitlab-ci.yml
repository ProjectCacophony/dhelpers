image: golang:1.10

variables:
  GO_PROJECT: gitlab.com/project-d-collab/dhelpers

stages:
  - test

before_script:
  - go get ${GO_PROJECT}
  - go get -v .
  - go get -v gopkg.in/alecthomas/gometalinter.v2

tests:
  stage: test
  script:
    - diff <(gofmt -d .) <(echo -n)
    - go test -v -race ./...
    - gometalinter.v2 ./... --deadline 5m